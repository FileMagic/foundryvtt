<!-- TODO: Potentially Reword based on feedback -->
<!-- Overview -->
<h2 class="border">Overview</h2>
<p>This article will guide you through the process of backing up your User Data and migrating to a new version of Foundry Virtual Tabletop or your Game System. We recommend making regular backups of your User Data, and especially before migrating your World or updating Foundry Virtual Tabletop.</p>
<p>This article will introduce you to the following concepts:</p>
<dl>
    <dt>Data Backup</dt>
    <dd>A copy of your Foundry VTT User Data, used in case of data loss or to return to an older version of Foundry Virtual Tabletop after migrating.</dd>
    <dt>Migration</dt>
    <dd>An automatic, irreversible process that updates your World's data to new version of Foundry Virtual Tabletop or your game system.</dd> 
    <dt>Data Sync Service</dt>
    <dd>A backup service that automatically backs up and replaces existing files. <strong>These services are incompatible with Foundry Virtual Tabletop and will cause irreversible data loss!</strong> See below for more information.</dd>
</dl>
<!-- Warning about synchronized backup services -->
<h3>Danger of Data Sync Backup Services</h3>
<p>Data sync services such as those offered by Dropbox, Google Drive, and Microsoft OneDrive, are not compatible with Foundry VTT. Foundry VTT makes frequent changes to your World's database files while running. A data sync service will inevitably copy these databases mid-operation, then restore them to this state later on. This leads to database corruption and irreversible data loss. <strong>Never use a data sync service with Foundry VTT! You WILL permanently lose your work!</strong></p>

<!-- Backing Up -->
<h2 class="border">Backing Up Your User Data</h2>
<p>Foundry VTT stores your User Data in a separate directory than the core software. This directory, known as your User Data Directory, contains several folders used by Foundry. Only the <b>Data</b> and <b>Config</b> folders need to be backed up.</p>

<!-- OS Specific Backups - Win, Mac, Linux -->
<!-- TODO: Pictures, at least for Linux. Potentially reformat how the commands are presented -->
<section class="collapsible">
    <header class="collapsible-header">Backing Up on Windows</header>
    <div class="collapsible-content">
        <ol> 
            <li>Launch Foundry Virtual Tabletop and right-click its icon in the taskbar. Click on 'Browse User Data.'</li>
            <li>Close Foundry by clicking the X in the top right corner. It should no longer show in the task bar.</li>
            <li>Copy the <b>Data</b> <b>Config</b> folders to another location on your PC.</li>
        </ol>
    </div>
</section>

<section class="collapsible">
    <header class="collapsible-header">Backing Up On MacOS</header>
    <div class="collapsible-content">
        <ol>
            <li>Launch Foundry Virtual Tabletop and navigate to the Configuration screen.</li>  
            <li>Copy the filepath from 'User Data Path'.</li>
            <li>Close out of Foundry by going to Foundry Virtual Tabletop in the top bar and selecting 'Quit.'</li>
            <li>Open 'Finder'.</li>
            <li>From the top menu bar, select 'Go' and then 'Go to Folder...'. Or, press Shift+Command+G</li> 
            <li>Paste in the filepath copied from the Configuration Screen and press Return.</li>
            <li>Copy the 'Data', 'Config', and 'Logs' folders to another location.</li>
        </ol>
    </div>
</section>

<section class="collapsible">
    <header class="collapsible-header">Backing Up On Linux</header>
        <div class="collapsible-content"> 
            <ol>
                <li>Launch Foundry Virtual Tabletop and navigate to the Configuration screen.</li>
                <li>Copy the filepath from 'User Data Path'.</li>
                <li>Close Foundry. If you're using a process manager, check that Foundry's process is no longer running.</li>
                <li>Open a terminal and navigate to your User Data folder by entering <code>cd &lt;/path/to/userdata/here&gt;</code>, pasting the copied path from before in place of <code>&lt;/path/to/userdata/here&gt;</code>.</li>
                <li>Create a compressed archive by entering <code>tar -czvf foundry-backup.tar.gz Data Config</code> then pressing 'Enter.'</li>
                <li>After the archive has finished, move it to another location. You can do this in the terminal using the <code>mv</code> command, eg <code>mv -v foundry-backup.tar.gz ~/foundry-backups</code>.</li>
            </ol>
            
                </div>
            </section>
 <h2 class="border">Restoring Your User Data</h2>
 <p>Restoring your User Data is as simple as closing Foundry and replacing the existing content in your User Data folder with the content from your backups. <b>Always check that your backup contains your User Data before overwriting or deleting any content from your User Data folder.</b></p>
<ul>
    <li>Windows and MacOS - Use the steps from the previous section to navigate to your User Data folder. Replace its contents with your backup.</li>
    <li>Linux - Use the steps from the previous section to find the path to your User Data. Copy the .tar.gz file to there and navigate to the directory using <code>cd /path/to/userdata/here</code>. Then enter the command <code>tar -xvf foundry-backup.tar.gz</code>, replacing "foundry-backup" with your archive name.</li>
</ul>
<p>After doing this, launch Foundry Virtual Tabletop as normal.</p>
<!-- Migrating Your World -->
<!-- TODO: Add image of migration dialog box-->
<h2 class="border">Migrating Your User Data</h2>
<p>New versions of Foundry VTT and Game Systems bring changes to how data is defined and stored. When an update occurs and a World is launched, Foundry VTT will automatically convert the existing data to work with these changes. This is known as Migration. <strong>Migrating a world is a one-way process. Once World Migration has begun, it is impossible for the World to work with older versions of Foundry. Always back up your User Data before migrating!</strong></p>
<p>Migrating your world data requires just a few steps:</p>
<ol>
    <li>Launch Foundry VTT and navigate to the Worlds screen.</li>
    <li>Find the world you intend to migrate and click 'Edit World.'</li>
    <li>Tick the box next to "Launch in safe configuration," then click 'Save.' For more information on launching in safe configuration, see @Article[launch-safe-configuration].</li>
    <li>Click 'Launch World'. A window will open and inform you that your World will migrate its data. <strong>If you have not made a backup, it is strongly suggested that you exit Foundry and make one before you proceed.</strong> To begin migration, click on 'Begin Migration.'</li>
    <li>Log into your World as normal. Foundry VTT will display a message indicating that data migration has begun. A message will pop up when migration is complete.</li>
    </ol>